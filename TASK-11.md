Этап 1. Доработки по таблице таблиц:
1. в _d дополнительно надо усложнить логику, надо учитывать только те таблицы, у которых в выражении Distributed указана текушая таблица, а не просто все зависимые _d таблицы-приемники. если у текущей таблицы есть таблица приемник, а у ней уже есть _d таблица, то такую _d таблицу не надо показывать.
2. всю логику с _d надо повторить и на вкладке Columns, для колонок, то есть надо добавить столбец _d, и изменить логику для Refs
3. надо добавить колонку справа от Size, с процентом занимаемого места от общего обьема, процеент показывать до 1 знака после запятой, и показывать знак процента. также эту колонку надо добавить и в Columns, с итогом по суммарному размеру таблицы и итогом по всем таблицам сервера (желательно 2 числв в 1 колонке, через "/")а
4. при открытии "Table Details" синий прямоуголник не ездит влево-вправо вслед за панелью, как это сделано в панели с подключениями
5. на вкладку с таблицей таблиц надо добавить текстовый фильтр по названию таблицы.

Этап 2. Добавление сводного дашборда по серверами и переделка структуры gui:
1. подключения из боковой панели убираем в Settings, в знак шестеренки, там в окне надо сделать вкладку для подключения в которой их можно задавать как сейчас, и надо добавить галочку что будет использоватся сертификат при SSL. Эта вкладка должна быть доступна только для администратора. Кнопку с тремя черточками слева сверху тоже убираем, тк панели слева больше нет.
2. На синей линии сверху, где написано "Clickhouse Analyser", надо добавить 2 кнопки справа: "All Servers", "by Server Details". При нажатии на "by Server Details" должно снизу показываться то, что реализовано сейчас - аналитика по конкретному серверу.
2.1. в "by Server Details", в верхнем блоке, где сейчас указано имя подключения (сервера), и занимаемое место на диске, там надо вместо надписи с именем подключения сделвть выпадающий список, в котором можно выбрать подключение, по которому дальше будут строиться все таблицы. По умолчанию должен быть выбран пунки "Выберите подключение", при этом ничего не строится пока не выбран конкретный сервер.
2.2. На вкладке "All Servers" надо сделать 2 блока один под другим:
2.2.1. в 1м блоке выводим сверху заголовок "Disk usage by servers", и затем ниже и слева направо:
- таблица с сводной информацией по серверам, с полями : имя сервера из подключения, занято место в читаемом формате, процент занятого места от общего обьема. Сортировка по убыванию по проценту занятого места. Если процент выше 80% то надо в 4й колонке показывать желтый знак предупреждения, и если больше 90% то красный восклицатейльный знак, знаки в виде иконок (красной и желтой). Отсечки в 80 и 90 процентов надо иметь возможность менять администратору через настройки. Также надо добавить 5ю колонку с кнопкой, на которой1 в квадратике нарисована стрелка вправо, при наведении показывать надписть "провалиться в детализацию по серверу", при нажатии на которую открывается вкладка "by Server Details", с установленным фильтром по этому серверу.
- график с почасовой динамикой занятого места по серверам, за последние 30 дней/90 дней, в процентах. Также нужна легенда с именоами серверов, и при наведентии на линию надо показывать имя сервера. Также надо нарисовать пунктирные линии с отсечками в 80 и 90% (точные значения взять из настроек). При нажатии на строку в сводной таблице по серверам, строка в таблице должна подсвечиваться фоновой заливкой, и на текущем графике надо выделить соответствующую линию, а остальные линии наоборот сделать менее выделяющимися.
2.2.2. во 2м блоке выводим сверху заголовок "Disk usage by tables (choose server)", и затем ниже и слева направо такие же таблицы и графики как в п. 2.2.1., с такой же логикой, но только топ таблиц для выбранного сервера, допустим топ-30, все прочие таблицы надо схлопнуть в строку "other". причем число выводимых таблиц можно выьирать в выпадаюшем списке (30, 50, 100). И если я нажимаю на кнопку "провалиться в детализацию по серверу", то открывается вкладка "by Server Details" с фильтром по выбранному серверу и таблице.
2.3. Если можно добавить блок с timeline под каждым графиком, для того чтобы можно было сделать zoom-in в более мелкий временной период, было бы круто.

Этап 3. Модуль мониторинга сервероа
1. модуль должен раз в час снимать и сохранять инфрмацию по занимаемому месту в байтах, в разрезе серверов и таблиц. Сохранять куда то в локальную субд, как вариант в duckdb, с хорошим сжатием. Также надо сохранять информацию по общему дисковому месту на сервере. Сохранять информацию надо с глубиной в 1 год, или по параметру из настроек. Надо чтобы в таблицах были партиции по году, и как только год "истек", то дропать сразу всю партицию.
2. элементы на вкладке "All Servers" должны снимать информацию из этой базы.
3. старайся минимизировать количество запросов к базам, в идеале - раз в час 1 запрос к 1 серверу.